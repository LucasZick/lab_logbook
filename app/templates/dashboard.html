{% extends "base.html" %}

{% block content %}
<style>
    .action-buttons .btn { margin-left: 0.5rem; }
</style>

<div class="content-card mb-4">
    <h3><i class="fas fa-tachometer-alt"></i> Painel do Professor</h3>
    <p class="text-muted">Gerencie as solicitações de registro e o status dos bolsistas.</p>
    
    <hr>
    <form action="{{ url_for('main.search') }}" method="get" class="d-flex mt-3">
        <input class="form-control me-2" type="search" name="q" placeholder="Buscar em todos os diários..." aria-label="Search" value="{{ request.args.get('q', '') }}">
        <button class="btn btn-primary" type="submit"><i class="fas fa-search"></i> Buscar</button>
    </form>
</div>

<div class="content-card mb-4">
    <h4><i class="fas fa-brain"></i> Análise Semanal com IA</h4>
    <p class="text-muted">Clique no botão abaixo para que a IA analise todos os registos dos bolsistas ativos na última semana e gere um relatório executivo com os principais avanços e pontos de atenção.</p>
    <a href="{{ url_for('main.generate_report') }}" class="btn btn-primary"><i class="fas fa-cogs"></i> Gerar Análise Semanal</a>
</div>

<div class="content-card mb-4">
    <h4><i class="fas fa-user-clock"></i> Solicitações de Registro Pendentes</h4>
    {% if pending_users %}
        <ul class="list-group">
            {% for user in pending_users %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <span><strong>{{ user.username }}</strong> <small class="text-muted">({{ user.email }})</small></span>
                <div class="action-buttons">
                    <a href="{{ url_for('main.approve_user', user_id=user.id) }}" class="btn btn-sm btn-success"><i class="fas fa-check"></i> Aprovar</a>
                    <a href="{{ url_for('main.reject_user', user_id=user.id) }}" class="btn btn-sm btn-danger" onclick="return confirm('Tem certeza?');"><i class="fas fa-times"></i> Rejeitar</a>
                </div>
            </li>
            {% endfor %}
        </ul>
    {% else %}
        <p class="text-muted">Nenhuma solicitação pendente.</p>
    {% endif %}
</div>
<div class="content-card mb-4">
    <h4><i class="fas fa-users"></i> Bolsistas Ativos</h4>
    {% if active_bolsistas %}
        <ul class="list-group">
            {% for bolsista in active_bolsistas %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <span><strong>{{ bolsista.username }}</strong></span>
                <div class="action-buttons">
                    <a href="{{ url_for('main.view_logs', student_id=bolsista.id) }}" class="btn btn-sm btn-primary"><i class="fas fa-eye"></i> Ver Diário</a>
                    <a href="{{ url_for('main.deactivate_user', user_id=bolsista.id) }}" class="btn btn-sm btn-warning" onclick="return confirm('Tem certeza?');"><i class="fas fa-user-slash"></i> Desativar</a>
                </div>
            </li>
            {% endfor %}
        </ul>
    {% else %}
        <p class="text-muted">Nenhum bolsista ativo no momento.</p>
    {% endif %}
</div>
<div class="content-card">
    <h4><i class="fas fa-user-lock"></i> Bolsistas Inativos</h4>
    {% if inactive_bolsistas %}
        <ul class="list-group">
            {% for bolsista in inactive_bolsistas %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <span><strong>{{ bolsista.username }}</strong></span>
                <div class="action-buttons">
                    <a href="{{ url_for('main.view_logs', student_id=bolsista.id) }}" class="btn btn-sm btn-outline-secondary"><i class="fas fa-eye"></i> Ver Histórico</a>
                    <a href="{{ url_for('main.activate_user', user_id=bolsista.id) }}" class="btn btn-sm btn-info" onclick="return confirm('Tem certeza?');"><i class="fas fa-user-check"></i> Reativar</a>
                </div>
            </li>
            {% endfor %}
        </ul>
    {% else %}
        <p class="text-muted">Nenhum bolsista inativo.</p>
    {% endif %}
</div>
{% endblock %}